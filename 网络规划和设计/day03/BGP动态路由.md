# BGP的动态路由

## 互联网的自治系统

- IETF将互联网划分为许多AS
- 每个AS有一个唯一的AS号码
- 全球AS号码由ICANN统一分配
- 16位AS号已耗尽,07年开始分配32位AS号
- 可用的AS号码数量非常有限,连接到ISP,并共享路由策略单位,可以使用私有AS号码

## BGP工作原理

BGP的基本特征

- BGP用来在AS之间传递路由信息
- 在BGP看来,整个Internet就是一个AS图
- BGP是一种路径矢量路由协议,属于外部网关协议(EGP)
- BGP在启动时,会传播整张路由表,以后只对网络变化的部分进行触发更新
- 全球互联网的BGP通告路由大概有10万多条

## BGP对等体组

- 路由器之间建立了一条BGP连接后,他们就成为邻居或对等体
- 运行BGP的路由器成为发言人
- BGP对等体的关系需要手动建立,BGP更新也是手动进行的

## 团体

- 一个大型AS就是一个团体
- BGP中的团体是共享公众属性的一组路由器

## BGP路由基本配置

- BGP中的'跳'是指AS,不是路由器,因此吓一跳不一定是直连的
- AS路径属性
  - 让BGP进程决策最优路径,越短越好
  - 防止环路

### 本地优先属性

- 告诉本地AS中的BGP路由器,从哪个出口出去才是最优路径
- 只用在与内部BGP邻居间的路由更新分组中

### 权重属性配置

- 权重是Cisco IOS的私有属性,仅在本地有效,即只在这台路由器上起作用
- 权重取值范围0-65535
- 权重值越大,路由优先级越高

### 归纳属性

- 使用归纳属性,将路由聚合成一条BGP路由通告进去,从而减轻网络设备路由处理负担
