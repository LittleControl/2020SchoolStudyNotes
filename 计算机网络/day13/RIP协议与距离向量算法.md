# RIP协议与距离向量算法

- RIP协议是一种分布式的基于距离向量的路由选择协议,是因特网的协议标准,最大优点是简单
- RIP协议要求网络中每一个路由器都维护从它自己到其他每一个目的网络的唯一最佳记录(即一组距离)
- 距离: 通常为"跳数",即从源端口到目的端口所经过的路由器个数,经过一个路由器跳数+1.特别的,从以路由器到直接连接的网络距离为1. RIP允许一条路最多包含15个路由器,因此距离为16表示网络不可达
- RIP协议只适用于小互联网

## RIP协议特点

- 仅和相邻路由器交换信息
- 路由器交换的信息是自己的路由表
- 每30s交换一次路由信息,然后路由器根据更新信息更新路由表.若超过180s没收到邻居路由器的通告,则判定邻居没了,并更新自己路由表
- 路由器开始工作时,只知道直接连接的网络的距离(距离为1), 接着每一个路由器也只和数目非常有限的相邻路由器交换并更新路由信息
- 经过若干次更新后,所有路由器最终都会知道到达本自治系统任何一个网络的最短距离和下一跳路由器的地址,即"收敛"

## 距离向量算法

- 修改相邻路由器发来的RIP中的所有表项
  - 对地址为X的相邻路由器发来的RIP报文,修改此报文中的所有项目: 把下一跳字段中的地址改为X,并把所有的距离字段+1
- 对修改后的RIP报文中的每一个项目,进行如下步骤
  - R1路由表中若没有Net3,则把该项目填入R1路由表
  - R1路由表中若有Net3,则查看下一跳路由器地址
    - 若下一跳是X, 则用收到的项目替换源路由表中的项目
    - 若下一跳不是X, 原来距离比X走的距离远则更新,否则不作处理
- 若180s还没有收到相邻路由器X的更新路由表,则把X记为不可达的路由器,即把距离设置为16
- 返回

## RIP协议的报文格式

- RIP是应用层协议,使用UDP传送数据
- 一个RIP报文最多可以包括25个路由,如超过,必须再使用一个RIP报文传送

## RIP优缺点

- RIP好消息传得快, 坏消息传得慢
- 当网络出现故障时,要经过比较长的时间(例如数分钟)才能将此信息传送到所有的路由器, "慢收敛"
