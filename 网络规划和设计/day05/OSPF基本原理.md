# OSPF基本原理

## 内部网关协议和外部网关协议

- 自治系统(AS)
- 内部网关协议(IGP)
- 外部网关协议(EGP)

***
OSPF是链路状态路由协议

## OSPF的相关概念

- 邻居列表
- 链路状态数据库
- 路由表
- OSPF的度量值
  - COST = 10的8次方 / BW(带宽)
  - 最短路径是基于接口指定的代价(cost)计算的
- OSPF的区域
  - 为了适应大型的网络,OSPF在AS内划分多个区域
  - 每个OSPF路由器只维护所在区域的完整链路信息
- 区域ID
  - 区域ID可以表示成一个十进制的数字
  - 也可以表示成一个IP
- 骨干区域Area 0
  - 负责区域间路由信息传播
- 非骨干区域
- Router ID
  - OSPF区域内唯一标识的路由器的IP地址
  - 选取规则
    - 首先选取路由器lookback接口上数值最高的IP地址
    - 如果没有lookpack接口,在物理端口中选取IP地址最高的
    - 也可以使用router-id命令指定Router ID

## OSPF将网络划分为四种类型

- 点到点网络
- 广播多路访问网络
- 非广播多路访问网络
- 点到多点网络

## DR和BDR

DR(指定路由器)  
BDR(备份指定路由器)

- DR选举
  - 先比较优先级(0-255)后比较Router ID
  - 优先级为0不参与DR和BDR选举
  - 通过组播发送Hello报文

## OSPF与RIP的比较

|           OSPF           |                   RIP v1 RIP v2                   |
| :----------------------: | :-----------------------------------------------: |
|     链路状态路由协议     |                 距离矢量路由协议                  |
|      没有跳数的限制      |     RIP的15跳限制,超过15跳的路由被认为不可达      |
| 支持可变长子网掩码(VLSM) |      不支持可变长子网掩码-支持可变长子网掩码      |
|        收敛速度快        |                    收敛速度慢                     |
| 使用组播发送链路状态更新 | 周期性广播更新整个路由表-周期性组播更新整个路由表 |

## OSPF协议报文

- Hello: 建立和维护邻接关系
- DD: 交换路由信息内容或摘要
- LSR
- LSU
- LSACK
