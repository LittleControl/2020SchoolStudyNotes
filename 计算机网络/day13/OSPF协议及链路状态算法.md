# OSPF协议及链路状态算法

- 开放最短路径优先OSPF协议: "开放"标明OSPF协议不是受一家厂商啊控制,而是公开发表的; "最短路径优先"时因为使用了'Dijkstra'提出的最短路径优先算法SPF
- OSPF最只要的特征就是使用了分布式的链路状态协议

## OSPF特点

- 使用洪泛算法向自治系统内所有路由器发送信息,即路由器通过输出端口向所有相邻的路由器发送信息,而每一个相邻路由器又再次将此信息发往其所有的相邻路由器
- 最终整个区域内所有路由器都得到了这么一个信息的副本
- 发送的信息就是与本路由器相邻的所有路由器的链路状态(本路由器和哪些路由器相邻,以及该链路的度量/代价——费用,距离,时延,带宽等)
- 只有当链路状态发生变化时,路由器才向所有路由器洪范发送此信息
- 最后,所有路由器都能建立一个链路状态数据库, 即全网拓扑图

## 链路状态路由算法

- 每个路由器发现它的邻居节点(HELLO问候分组), 并了解邻居节点的网络信息
- 设置到它的每个邻居的成本度量metric
- 构造(DD数据库描述分组), 向邻站给出自己的链路状态数据库中的所有链路状态项目的摘要信息
- 如果DD分组中的摘要自己都有,则邻站不做处理,如果没有的或者是更新的,则发送(LSR链路状态请求分组),请求自己没有的和比自己更新的信息
- 收到邻站的LSR分组后,发送(LSU链路状态更新分组)进行更新
- 更新完毕后,邻站返回一个(LSAck链路状态确认分组)进行确认

只要一个路由器的链路状态发生变化

- 泛洪发送(LSU链路状态更新分组)进行更新
- 更新完毕后,其他站返回一个(LSAck链路状态确认分组)进行确认
- 使用Dijkstra根据自己的链路状态数据库构造到其他节点间的最短路径

## OSPF的区域

- 在一个区域内的路由器最好不超过200个
- 主干路由器
- 区域边界路由器
- 自治系统边界路由器
- 区域内部路由器

## OSPF分组

- OSPF分组使用IP数据报传送
- 暂时当作网络层协议

## OSPF其他特点

- 每隔30min,要刷新一次数据库中的链路状态
- 由于一个路由器的链路状态只涉及到与相邻路由器的连通状态,因而与整个互联网的规模并无直接关系,因此当互联网规模很大时,OSPF协议要比距离向量协议RIP好得多
- OSPF不存在坏消息传得慢的问题,它的收敛速度很快
