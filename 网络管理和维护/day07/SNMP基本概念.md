# SNMP基本概念

## SNMP封装

和FTP类似,SNMP操作使用两个熟知端口(well-known ports)

- UDP Port 161 ——SNMP Messages
- UDP Port 162 ——SNMP Trap Messages

## SNMP团体

- SNMP网络管理是一种分布式应用.这种应用的特点是管理站和代理之间的关系可以是一对多的关系,也可能是多对一的关系
- 这使得每个代理除了维护自己本地MIB以外,同时还必须控制多个管理站对这个MIB的访问,这包括:
- 是否允许某个管理站的访问
- 已授权管理站的访问权限
- SNMP提供了一种简单而且有限的安全保护能力: 验证团体名(Community name)
- 一个团体是一个代理和某个管理站之间的一种关系
- 允许访问的团体是在代理一侧本地定义的,即"团体"是一个在代理者系统中定义的本地概念,如果一个代理要与多个管理站进行通信,那么该代理可能需要定义多个团体,用于识别每个团体的团体名在代理者系统中是唯一的
- 不同的代理者可能会定义相同的团体名,因此管理站在作任何应用(如: 发送查询请求)时应将团体名和代理者联系起来
- SNMP的认证方式是: 从管理站发往代理的每个报文都包含一个团体名,团体名被认证,则报文有效
- 团体名是判断是否有第三方试图以无效身份访问一个设备的主要途径.SNMP代理不接受来自所定义团体以外的SNMP请求
- 团体定义了认证,访问控制和代理的特性
- 最初的SNMP网络管理框架由四个文件定义
- RFC1155: 规定了管理对象的语法和语义,定义宏OBJECT-TYPE
- RFC1213: 定义了MIB-II管理对象的核心集合
- RFC1212: 在RFC1155的基础上,对宏OBJECT-TYPE重新做了改进性定义
- RFC1157: SNMP v1的协议规范
- SNMP管理信息模型: SMI, MIB
- SMI和MIB都是ASN.1语法定义的模块

## SNMP管理信息模型之MIB

- 管理对象的集合被组织成一个树形的结构,称为MIB.
  - 管理对象由OID进行标识
  - OID描述了管理对象在树中的精确位置
- 网络中每个系统(服务器,路由器,网桥等)都拥有一个反映系统中被管资源的MIB
- 管理站通过读取MIB对象的值进行网络监测(监测被管资源)
- 管理站可以在代理者处产生动作,也可以通过修改变量值改变代理者处的位置(控制被管资源)

## SNMP管理信息模型之SMI

- SMI为定义和构造MIB提供了一个通用的框架. SMI的目的是为定义管理对象提供统一的标准
- SMI规定可以在MIB中使用的数据类型,说明资源在MIB中怎样表示和命名.即规定了管理对象的语法和语义,说明了怎样定义管理对象和怎样访问管理对象
- SMI的宗旨是保持MIB的简单性和可拓展性,只允许存储标量和表(二维数组),不支持复杂的数据结构

### SMI的内容主要包括

- 为MIB中定义的对象分配OID
- 规定可以在MIB中使用的数据类型(包括ASN.1通用类型和SNMP应用中特有的应用类型).换言之,SMI模块中定义的数据类型,会被MIB模块引用
- 提供对象类型的宏定义(利用这个宏定义,在MIB中定义被管对象).换言之,为在MIB中定义被管对象提供统一的标准
- SMIv1和SMIv2是SMI的两个版本
- SMIv1由RFC1155,RFC1212,RFC1215三个RFC文件组成
- RFC1155, 为MIB中定义的对象分配OID, 定义数据类型,定义宏OBJECT-TYPE
- RFC1212, 在RFC1155的基础上对宏OBJECT-TYPE进行了改进
- RFC1215, 提供了MIB中定义Trap的宏
- 现阶段,学习SMI和MIB应关注以下两点
- SMIv1主要内容和模块定义
- 如何使用宏OBJECT-TYPE在MIB中定义被管对象
